import{_ as m}from"./ProfileEditor.380ad268.js";import{i as h,a as d,R as _}from"./index.eddda93d.js";import{d as v,u as w,b as B,e as y,a4 as r,ab as I,o as C,f as A,g as f,j as n,aj as D,h as i,ak as E}from"./vendor.b2c28a85.js";import"./UserBrief.494b4d44.js";const N=v({setup(P){const e=h(),s=w(),p=B(),c=y(()=>e.state.user),l=r([]);I(()=>{e.dispatch("fetchColleges").then(()=>{l.value=e.state.colleges})});const t=r(!1);async function F(a){try{t.value=!0,await d.updateSelfInfo(a),e.dispatch("fetchUserInfo"),s.success("\u66F4\u65B0\u6210\u529F\uFF01"+(c.value.role===_.Admin?"":"(\u60A8\u4E0D\u662F\u7BA1\u7406\u5458\uFF0C\u53EA\u80FD\u66F4\u65B0\u90E8\u5206\u4FE1\u606F)"))}catch(u){s.error("\u66F4\u65B0\u5931\u8D25\uFF01"+u.message)}finally{t.value=!1}}const o=r(!1);async function g(a){try{o.value=!0,await d.updatePassword(a),s.success("\u66F4\u65B0\u5BC6\u7801\u6210\u529F\uFF01"),e.dispatch("logout"),p.push("/login")}catch(u){s.error("\u66F4\u65B0\u5931\u8D25\uFF01"+u.message)}finally{o.value=!1}}return(a,u)=>(C(),A(n(D),{cols:12},{default:f(()=>[i(n(E),{offset:1,span:10},{default:f(()=>[i(m,{user:n(c),colleges:l.value,"updating-info":t.value,"updating-password":o.value,onUpdateInfo:F,onUpdatePassword:g},null,8,["user","colleges","updating-info","updating-password"])]),_:1})]),_:1}))}});export{N as default};
